import Link from "next/link";
import Card from "@mui/material/Card";
import Typography from "@mui/material/Typography";
import FlexBox from "components/flex-box/flex-box";
import { toPersianNumber } from "@/utils/persian";
import type { UserResource } from "@/types/auth.types";

type Props = { user: UserResource };

export default function UserInfo({ user }: Props) {
  const birthDate = user.birth_year && user.birth_month && user.birth_day
    ? `${toPersianNumber(user.birth_day)}/${toPersianNumber(user.birth_month)}/${toPersianNumber(user.birth_year)}`
    : "-";

  return (
    <Link href="/profile/edit">
      <Card
        elevation={0}
        sx={{
          marginTop: 3,
          display: "flex",
          flexWrap: "wrap",
          border: "1px solid",
          borderColor: "grey.100",
          padding: "0.75rem 1.5rem",
          flexDirection: { md: "row", xs: "column" },
          alignItems: { md: "center", xs: "flex-start" },
          justifyContent: { md: "space-between", xs: "flex-start" }
        }}>
        <TableRowItem title="نام" value={user.first_name || "-"} />
        <TableRowItem title="نام خانوادگی" value={user.last_name || "-"} />
        {user.email && <TableRowItem title="ایمیل" value={user.email} />}
        <TableRowItem title="تلفن" value={toPersianNumber(user.mobile)} />
        <TableRowItem title="کد کاربری" value={toPersianNumber(user.username)} />
        <TableRowItem title="تاریخ تولد" value={birthDate} />
      </Card>
    </Link>
  );
}

function TableRowItem({ title, value }: { title: string; value: string }) {
  return (
    <FlexBox flexDirection="column" p={1}>
      <Typography variant="body1" color="text.secondary" sx={{ mb: 0.5 }}>
        {title}
      </Typography>
      <span>{value}</span>
    </FlexBox>
  );
}
